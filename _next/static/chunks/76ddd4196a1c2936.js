(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,72906,e=>{"use strict";var r=e.i(43476),t=e.i(56348);e.i(36180);var s=e.i(98925),a=e.i(59141);let d=async e=>{let r=(0,s.doc)(a.firestore,"admins",e);return(await (0,s.getDoc)(r)).exists()},i=e=>{let t="not-logged-in"===e.type;return(0,r.jsx)("div",{className:"p-6 max-w-2xl mx-auto",children:(0,r.jsxs)("div",{className:`border rounded p-6 ${t?"bg-red-50 dark:bg-red-900 border-red-200 dark:border-red-800":"bg-yellow-50 dark:bg-yellow-900 border-yellow-200 dark:border-yellow-800"}`,children:[(0,r.jsx)("h2",{className:`text-xl font-bold mb-2 ${t?"text-red-800 dark:text-red-200":"text-yellow-800 dark:text-yellow-200"}`,children:t?"アクセス権限がありません":"管理者権限がありません"}),(0,r.jsx)("p",{className:`mb-4 ${t?"text-red-600 dark:text-red-300":"text-yellow-700 dark:text-yellow-300"}`,children:t?"管理者としてログインする必要があります。":(0,r.jsxs)(r.Fragment,{children:["このアカウントには管理者権限が付与されていません。",(0,r.jsx)("br",{}),"UID: ",e.uid]})}),(0,r.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",onClick:e.onAction,children:t?"ホームに戻る":"ログアウト"})]})})};var n=e.i(71645),l=e.i(79472),o=e.i(25026),c=e.i(80368);let x=async e=>(await (0,s.addDoc)((0,s.collection)(a.firestore,"questions"),{text:e.text,options:e.options,order:e.order,createdAt:(0,s.serverTimestamp)()})).id,m=async e=>{let r=(0,s.doc)(a.firestore,"questions",e.id);await (0,s.updateDoc)(r,{text:e.text,options:e.options,order:e.order})},u=async e=>{let r=(0,s.doc)(a.firestore,"questions",e);await (0,s.deleteDoc)(r)},b=({questions:e,onUpdate:t})=>{let[s,a]=(0,n.useState)(null),[d,i]=(0,n.useState)(!1),[l,o]=(0,n.useState)({text:"",options:["","",""],order:0}),c=()=>{o({text:"",options:["","",""],order:0}),a(null),i(!1)},b=async()=>{let e=l.options.filter(e=>e.trim());if(!l.text.trim())return void alert("質問文を入力してください");if(e.length<2)return void alert("選択肢を2つ以上入力してください");try{await x({text:l.text,options:e,order:l.order}),c(),t()}catch(e){console.error("質問の作成に失敗しました:",e),alert("質問の作成に失敗しました。もう一度お試しください。")}},g=async()=>{let e=l.options.filter(e=>e.trim());if(s){if(!l.text.trim())return void alert("質問文を入力してください");if(e.length<2)return void alert("選択肢を2つ以上入力してください");try{await m({id:s.id,text:l.text,options:e,order:l.order}),c(),t()}catch(e){console.error("質問の更新に失敗しました:",e),alert("質問の更新に失敗しました。もう一度お試しください。")}}},h=async e=>{if(confirm("この質問を削除しますか？"))try{await u(e),t()}catch(e){console.error("質問の削除に失敗しました:",e),alert("質問の削除に失敗しました。もう一度お試しください。")}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"質問管理"}),(0,r.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600",onClick:()=>{i(!0),a(null),o({text:"",options:["","",""],order:e.length})},children:"新規質問作成"})]}),(0,r.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,r.jsx)("div",{className:"border rounded p-4 bg-white shadow dark:bg-gray-800 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"font-bold mb-2",children:e.text}),(0,r.jsx)("ul",{className:"ml-4 text-sm text-gray-600 dark:text-gray-400",children:e.options.map((e,t)=>(0,r.jsxs)("li",{children:["・",e]},t))})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",onClick:()=>{a(e),o({text:e.text,options:[...e.options,""],order:e.order}),i(!1)},children:"編集"}),(0,r.jsx)("button",{className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",onClick:()=>h(e.id),children:"削除"})]})]})},e.id))}),(d||s)&&(0,r.jsxs)("div",{className:"border rounded p-6 bg-gray-50 shadow-lg dark:bg-gray-800 dark:border-gray-700",children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-4",children:s?"質問を編集":"新規質問"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"質問文"}),(0,r.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:l.text,onChange:e=>o({...l,text:e.target.value}),placeholder:"質問を入力"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"選択肢（最低2つ）"}),l.options.map((e,t)=>(0,r.jsxs)("div",{className:"mb-2 flex gap-2",children:[(0,r.jsx)("input",{type:"text",className:"flex-1 border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:e,onChange:e=>{let r=[...l.options];r[t]=e.target.value,o({...l,options:r})},placeholder:`選択肢 ${t+1}`}),t>=2&&(0,r.jsx)("button",{className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",onClick:()=>{let e=l.options.filter((e,r)=>r!==t);o({...l,options:e})},children:"削除"})]},t)),(0,r.jsx)("button",{className:"text-blue-600 text-sm hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:()=>o({...l,options:[...l.options,""]}),children:"+ 選択肢を追加"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"表示順序"}),(0,r.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:l.order,onChange:e=>o({...l,order:parseInt(e.target.value)||0})})]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,r.jsx)("button",{className:"bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500 dark:bg-gray-600 dark:hover:bg-gray-700",onClick:c,children:"キャンセル"}),(0,r.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",onClick:s?g:b,children:s?"更新":"作成"})]})]})]})]})},g=async e=>(await (0,s.addDoc)((0,s.collection)(a.firestore,"resultPatterns"),{name:e.name,message:e.message,description:e.description,conditions:e.conditions,priority:e.priority,order:e.order,createdAt:(0,s.serverTimestamp)()})).id,h=async e=>{let r=(0,s.doc)(a.firestore,"resultPatterns",e.id);await (0,s.updateDoc)(r,{name:e.name,message:e.message,description:e.description,conditions:e.conditions,priority:e.priority,order:e.order})},p=async e=>{let r=(0,s.doc)(a.firestore,"resultPatterns",e);await (0,s.deleteDoc)(r)},y=({patterns:e,questions:t,onUpdate:s})=>{let[a,d]=(0,n.useState)(null),[i,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)({name:"",message:"",description:"",conditions:[{questionId:"",selectedOption:""}],priority:10,order:0}),x=()=>{c({name:"",message:"",description:"",conditions:[{questionId:"",selectedOption:""}],priority:10,order:0}),d(null),l(!1)},m=()=>{if(!o.name.trim())return alert("結果パターン名を入力してください"),null;if(!o.message.trim())return alert("メッセージを入力してください"),null;let e=o.conditions.filter(e=>{if(!e.questionId||!e.selectedOption.trim())return!1;let r=t.find(r=>r.id===e.questionId);return!!r&&!!r.options.includes(e.selectedOption)});if(0===e.length)return alert("少なくとも1つの有効な条件を設定してください"),null;let r=o.conditions.length-e.length;return r>0&&alert(`${r}件の無効な条件が除外されました。削除された質問や選択肢を参照している条件は保存できません。`),e},u=async()=>{let e=m();if(e)try{await g({name:o.name,message:o.message,description:o.description,conditions:e,priority:o.priority,order:o.order}),x(),s()}catch(e){console.error("結果パターンの作成に失敗しました:",e),alert("結果パターンの作成に失敗しました。もう一度お試しください。")}},b=async()=>{if(!a)return;let e=m();if(e)try{await h({id:a.id,name:o.name,message:o.message,description:o.description,conditions:e,priority:o.priority,order:o.order}),x(),s()}catch(e){console.error("結果パターンの更新に失敗しました:",e),alert("結果パターンの更新に失敗しました。もう一度お試しください。")}},y=async e=>{if(confirm("この結果パターンを削除しますか？"))try{await p(e),s()}catch(e){console.error("結果パターンの削除に失敗しました:",e),alert("結果パターンの削除に失敗しました。もう一度お試しください。")}},j=(e,r,t)=>{let s=[...o.conditions];s[e]={...s[e],[r]:t},c({...o,conditions:s})};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"結果パターン管理"}),(0,r.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600",onClick:()=>{l(!0),d(null),c({name:"",message:"",description:"",conditions:[{questionId:"",selectedOption:""}],priority:10,order:e.length})},children:"新規パターン作成"})]}),(0,r.jsx)("div",{className:"space-y-4",children:0===e.length?(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"結果パターンがありません。新規作成してください。"}):e.map(e=>(0,r.jsx)("div",{className:"border rounded p-4 bg-white shadow dark:bg-gray-800 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("span",{className:"font-bold text-lg",children:e.name}),(0,r.jsxs)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded dark:bg-blue-900 dark:text-blue-200",children:["優先度: ",e.priority]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-2 dark:text-gray-300",children:e.message}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2 dark:text-gray-400",children:e.description}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:[(0,r.jsx)("p",{className:"font-semibold mb-1",children:"条件:"}),(0,r.jsx)("ul",{className:"ml-4 space-y-1",children:e.conditions.map((e,s)=>{var a;let d;return(0,r.jsxs)("li",{children:["・",(a=e.questionId,(d=t.find(e=>e.id===a))?d.text:a?`削除された質問 (ID: ${a})`:"")," → 「",e.selectedOption,"」"]},s)})})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",onClick:()=>{d(e),c({name:e.name,message:e.message,description:e.description||"",conditions:[...e.conditions],priority:e.priority,order:e.order}),l(!1)},children:"編集"}),(0,r.jsx)("button",{className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",onClick:()=>y(e.id),children:"削除"})]})]})},e.id))}),(i||a)&&(0,r.jsxs)("div",{className:"border rounded p-6 bg-gray-50 shadow-lg dark:bg-gray-800 dark:border-gray-700",children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-4",children:a?"結果パターンを編集":"新規結果パターン"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["パターン名 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:o.name,onChange:e=>c({...o,name:e.target.value}),placeholder:"例: リーダータイプ"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["メッセージ ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("textarea",{className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:o.message,onChange:e=>c({...o,message:e.target.value}),placeholder:"例: あなたは生まれながらのリーダーです！",rows:3})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"詳細説明（オプション）"}),(0,r.jsx)("textarea",{className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:o.description,onChange:e=>c({...o,description:e.target.value}),placeholder:"追加の説明文",rows:2})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["条件（少なくとも1つ） ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-2 dark:text-gray-400",children:"これらの条件がすべて満たされた場合にこの結果が表示されます"}),o.conditions.map((e,s)=>{var a;let d;return(0,r.jsx)("div",{className:"mb-3 p-3 border rounded bg-white dark:bg-gray-700 dark:border-gray-600",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium mb-1",children:"質問"}),(0,r.jsxs)("select",{className:"w-full border rounded px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-600 dark:text-white",value:e.questionId,onChange:e=>j(s,"questionId",e.target.value),children:[(0,r.jsx)("option",{value:"",children:"-- 質問を選択 --"}),t.map(e=>(0,r.jsx)("option",{value:e.id,children:e.text},e.id))]})]}),e.questionId&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium mb-1",children:"選択肢"}),(0,r.jsxs)("select",{className:"w-full border rounded px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-600 dark:text-white",value:e.selectedOption,onChange:e=>j(s,"selectedOption",e.target.value),children:[(0,r.jsx)("option",{value:"",children:"-- 選択肢を選択 --"}),(a=e.questionId,(d=t.find(e=>e.id===a))?d.options:[]).map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),o.conditions.length>1&&(0,r.jsx)("button",{className:"text-red-600 text-xs hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",onClick:()=>{let e;return e=o.conditions.filter((e,r)=>r!==s),void c({...o,conditions:e})},children:"この条件を削除"})]})},s)}),(0,r.jsx)("button",{className:"text-blue-600 text-sm hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",onClick:()=>{c({...o,conditions:[...o.conditions,{questionId:"",selectedOption:""}]})},children:"+ 条件を追加"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"優先度"}),(0,r.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:o.priority,onChange:e=>{let r=parseInt(e.target.value,10);c({...o,priority:isNaN(r)?o.priority:r})}}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1 dark:text-gray-400",children:"高い方が優先してマッチします"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"表示順序"}),(0,r.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:o.order,onChange:e=>{let r=parseInt(e.target.value,10);c({...o,order:isNaN(r)?o.order:r})}})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,r.jsx)("button",{className:"bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500 dark:bg-gray-600 dark:hover:bg-gray-700",onClick:x,children:"キャンセル"}),(0,r.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",onClick:a?b:u,children:a?"更新":"作成"})]})]})]})]})};async function j(e){let r=(0,s.collection)(a.firestore,"questionAnswers");return(await (0,s.addDoc)(r,{...e,createdAt:(0,s.serverTimestamp)()})).id}async function k(e){let r=(0,s.doc)(a.firestore,"questionAnswers",e.id),t={questionId:e.questionId,name:e.name,message:e.message,description:e.description,condition:e.condition,order:e.order};await (0,s.updateDoc)(r,t)}async function v(e){let r=(0,s.doc)(a.firestore,"questionAnswers",e);await (0,s.deleteDoc)(r)}let N=({questionAnswers:e,questions:t,onUpdate:s})=>{var a;let d,[i,l]=(0,n.useState)(null),[o,c]=(0,n.useState)(!1),[x,m]=(0,n.useState)({questionId:"",name:"",message:"",description:"",condition:{selectedOption:""},order:0}),u=()=>{m({questionId:"",name:"",message:"",description:"",condition:{selectedOption:""},order:0}),l(null),c(!1)},b=()=>{if(!x.questionId)return alert("質問を選択してください"),!1;if(!x.name.trim())return alert("回答パターン名を入力してください"),!1;if(!x.message.trim())return alert("メッセージを入力してください"),!1;if(!x.condition.selectedOption.trim())return alert("選択肢を指定してください"),!1;let e=t.find(e=>e.id===x.questionId);return e?!!e.options.includes(x.condition.selectedOption)||(alert("選択された選択肢が質問に存在しません"),!1):(alert("選択された質問が見つかりません"),!1)},g=async()=>{if(b())try{await j({questionId:x.questionId,name:x.name,message:x.message,description:x.description,condition:x.condition,order:x.order}),u(),s()}catch(e){console.error("質問回答パターンの作成に失敗しました:",e),alert("質問回答パターンの作成に失敗しました。もう一度お試しください。")}},h=async()=>{if(i&&b())try{await k({id:i.id,questionId:x.questionId,name:x.name,message:x.message,description:x.description,condition:x.condition,order:x.order}),u(),s()}catch(e){console.error("質問回答パターンの更新に失敗しました:",e),alert("質問回答パターンの更新に失敗しました。もう一度お試しください。")}},p=async e=>{if(confirm("この質問回答パターンを削除しますか？"))try{await v(e),s()}catch(e){console.error("質問回答パターンの削除に失敗しました:",e),alert("質問回答パターンの削除に失敗しました。もう一度お試しください。")}},y=t.map(r=>({question:r,answers:e.filter(e=>e.questionId===r.id)}));return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"質問回答パターン管理"}),(0,r.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600",onClick:()=>{c(!0),l(null),m({questionId:"",name:"",message:"",description:"",condition:{selectedOption:""},order:e.length})},children:"新規パターン作成"})]}),(0,r.jsx)("div",{className:"space-y-6",children:0===y.length?(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"質問がありません。"}):y.map(({question:e,answers:t})=>(0,r.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow dark:bg-gray-800 dark:border-gray-700",children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-3 text-gray-800 dark:text-gray-200",children:e.text}),0===t.length?(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"この質問の回答パターンはまだありません"}):(0,r.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,r.jsx)("div",{className:"border rounded p-3 bg-gray-50 dark:bg-gray-700 dark:border-gray-600",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("span",{className:"font-bold",children:e.name}),(0,r.jsxs)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded dark:bg-blue-900 dark:text-blue-200",children:["選択肢: ",e.condition.selectedOption]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-1 dark:text-gray-300",children:e.message}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",onClick:()=>{l(e),m({questionId:e.questionId,name:e.name,message:e.message,description:e.description||"",condition:{...e.condition},order:e.order}),c(!1)},children:"編集"}),(0,r.jsx)("button",{className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",onClick:()=>p(e.id),children:"削除"})]})]})},e.id))})]},e.id))}),(o||i)&&(0,r.jsxs)("div",{className:"border rounded p-6 bg-gray-50 shadow-lg dark:bg-gray-800 dark:border-gray-700",children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-4",children:i?"質問回答パターンを編集":"新規質問回答パターン"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["質問 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("select",{className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:x.questionId,onChange:e=>m({...x,questionId:e.target.value,condition:{selectedOption:""}}),children:[(0,r.jsx)("option",{value:"",children:"-- 質問を選択 --"}),t.map(e=>(0,r.jsx)("option",{value:e.id,children:e.text},e.id))]})]}),x.questionId&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["選択肢 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("select",{className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:x.condition.selectedOption,onChange:e=>m({...x,condition:{selectedOption:e.target.value}}),children:[(0,r.jsx)("option",{value:"",children:"-- 選択肢を選択 --"}),(a=x.questionId,(d=t.find(e=>e.id===a))?d.options:[]).map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["パターン名 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:x.name,onChange:e=>m({...x,name:e.target.value}),placeholder:"例: ポジティブタイプ"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["メッセージ ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("textarea",{className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:x.message,onChange:e=>m({...x,message:e.target.value}),placeholder:"例: 素晴らしい選択です！",rows:3})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"詳細説明（オプション）"}),(0,r.jsx)("textarea",{className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:x.description,onChange:e=>m({...x,description:e.target.value}),placeholder:"追加の説明文",rows:2})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"表示順序"}),(0,r.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",value:x.order,onChange:e=>{let r=parseInt(e.target.value,10);m({...x,order:isNaN(r)?x.order:r})}}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1 dark:text-gray-400",children:"小さい方が優先して表示されます"})]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,r.jsx)("button",{className:"bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500 dark:bg-gray-600 dark:hover:bg-gray-700",onClick:u,children:"キャンセル"}),(0,r.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",onClick:i?h:g,children:i?"更新":"作成"})]})]})]})]})};var f=e.i(79268);let w=({email:e,uid:t,onLogout:s})=>(0,r.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"管理者画面"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e||t})]}),(0,r.jsx)("button",{className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",onClick:s,children:"ログアウト"})]}),q=({userEmail:e,userId:t,onLogout:s})=>{let[a,d]=(0,n.useState)([]),[i,x]=(0,n.useState)(!1),[m,u]=(0,n.useState)([]),[g,h]=(0,n.useState)(!1),[p,j]=(0,n.useState)([]),[k,v]=(0,n.useState)(!1);(0,n.useEffect)(()=>{i||(0,l.getQuestions)().then(e=>{d(e),x(!0)}).catch(e=>{console.error("Failed to load questions:",e),x(!0)})},[i]),(0,n.useEffect)(()=>{g||(0,o.getResultPatterns)().then(e=>{u(e),h(!0)}).catch(e=>{console.error("Failed to load result patterns:",e),h(!0)})},[g]),(0,n.useEffect)(()=>{k||(0,c.getQuestionAnswers)().then(e=>{j(e),v(!0)}).catch(e=>{console.error("Failed to load question answers:",e),v(!0)})},[k]);let q=async()=>{d(await (0,l.getQuestions)())},C=async()=>{u(await (0,o.getResultPatterns)())},I=async()=>{j(await (0,c.getQuestionAnswers)())};return(0,r.jsxs)("main",{className:"p-6 max-w-6xl mx-auto",children:[(0,r.jsx)(w,{email:e,uid:t,onLogout:s}),(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)(b,{questions:a,onUpdate:q}),(0,r.jsx)("div",{className:"border-t pt-6 dark:border-gray-700",children:(0,r.jsx)(N,{questionAnswers:p,questions:a,onUpdate:I})}),(0,r.jsx)("div",{className:"border-t pt-6 dark:border-gray-700",children:(0,r.jsx)(y,{patterns:m,questions:a,onUpdate:C})}),(0,r.jsxs)("div",{className:"border-t pt-6 dark:border-gray-700",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"回答結果"}),(0,r.jsx)(f.ResultList,{questions:a})]})]})]})};e.i(51718);var C=e.i(18357);let I=async()=>{await (0,C.signOut)(a.firebaseAuth)};function O(){let{user:e,loading:s}=(0,t.useAuth)(),[a,l]=(0,n.useState)(!1),[o,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let r=async()=>{e&&l(await d(e.uid)),c(!1)};s||r()},[e,s]);let x=async()=>{await I(),window.location.href="/"};return s||o?(0,r.jsx)("p",{className:"p-6",children:"Loading..."}):!e||e.isAnonymous?(0,r.jsx)(i,{type:"not-logged-in",onAction:()=>{window.location.href="/"}}):a?(0,r.jsx)(q,{userEmail:e.email,userId:e.uid,onLogout:x}):(0,r.jsx)(i,{type:"insufficient-permissions",uid:e.uid,onAction:x})}e.s(["default",()=>O],72906)}]);