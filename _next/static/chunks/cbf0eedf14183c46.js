(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,79472,e=>{"use strict";var r=e.i(86134),t=e.i(85149);let s=async()=>(0,r.getCollection)(t.COLLECTIONS.QUESTIONS,"order","asc");e.s(["getQuestions",0,s])},45455,e=>{"use strict";e.i(36180);var r=e.i(98925),t=e.i(59141),s=e.i(85149);e.s(["watchResults",0,e=>{let a=(0,r.query)((0,r.collection)(t.db,s.COLLECTIONS.ANSWERS),(0,r.orderBy)("createdAt","asc"));return(0,r.onSnapshot)(a,r=>{e(r.docs.map(e=>({id:e.id,...e.data()})))})}])},80368,e=>{"use strict";var r=e.i(86134),t=e.i(85149);let s=async()=>(0,r.getCollection)(t.COLLECTIONS.QUESTION_ANSWERS,"order","asc");e.s(["getQuestionAnswers",0,s])},79268,77691,77971,e=>{"use strict";var r=e.i(43476),t=e.i(71645),s=e.i(45455),a=e.i(80368);function i(e,r,t){let s=t.filter(t=>t.questionId===e&&t.condition.selectedOption===r);if(0!==s.length)return s.sort((e,r)=>e.order!==r.order?e.order-r.order:e.id.localeCompare(r.id)),s[0]}e.s(["findMatchingQuestionAnswer",()=>i],77691),e.i(16787);var n=e.i(41635);let l=({questionAnswer:e})=>(0,r.jsxs)(n.GradientCard,{variant:"gradient-blue",className:"p-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-2",children:e.name}),(0,r.jsx)("p",{className:"text-base leading-relaxed",children:e.message}),e.description&&(0,r.jsx)("p",{className:"mt-2 text-sm leading-relaxed opacity-90",children:e.description})]});e.s(["QuestionPersonalizedAnswer",0,l],77971),e.s(["ResultList",0,({questions:e})=>{let[n,d]=(0,t.useState)([]),[o,c]=(0,t.useState)([]),[u,m]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{let e=(0,s.watchResults)(d);return()=>e()},[]),(0,t.useEffect)(()=>{let e=!0;return(0,a.getQuestionAnswers)().then(r=>{e&&(c(r),m(!1))}).catch(r=>{console.error("Failed to load question answers:",r),e&&m(!1)}),()=>{e=!1}},[]),(0,r.jsx)("div",{className:"space-y-6",children:e.map(e=>{let t=n.filter(r=>r.questionId===e.id);return(0,r.jsxs)("div",{className:"border rounded p-4 dark:border-gray-700 dark:bg-gray-800",children:[(0,r.jsx)("h3",{className:"font-bold mb-2",children:e.text}),e.options.map(s=>{let a=t.filter(e=>e.selectedOption===s),n=u?null:i(e.id,s,o);return(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("span",{className:"font-medium",children:[s,"（",a.length,"）"]}),n&&(0,r.jsx)("div",{className:"mt-2 ml-4",children:(0,r.jsx)(l,{questionAnswer:n})}),(0,r.jsx)("ul",{className:"ml-4 text-sm text-gray-600 dark:text-gray-400 mt-2",children:a.map(e=>(0,r.jsxs)("li",{children:["・",e.userName]},e.id))})]},s)})]},e.id)})})}],79268)},32832,36841,72585,56309,53902,52928,e=>{"use strict";var r=e.i(85149);e.s(["validateQuestionAnswerForm",0,(e,t,s,a,i)=>{if(!e)return r.VALIDATION_MESSAGES.REQUIRED_QUESTION_SELECT;if(!t.trim())return r.VALIDATION_MESSAGES.REQUIRED_PATTERN_NAME;if(!s.trim())return r.VALIDATION_MESSAGES.REQUIRED_MESSAGE;if(!a.trim())return r.VALIDATION_MESSAGES.REQUIRED_OPTION_SELECT;let n=i.find(r=>r.id===e);return n?n.options.includes(a)?void 0:r.VALIDATION_MESSAGES.OPTION_NOT_IN_QUESTION:r.VALIDATION_MESSAGES.QUESTION_NOT_FOUND},"validateQuestionForm",0,(e,t)=>e.trim()?t.filter(e=>e.trim()).length<r.UI_CONSTANTS.MIN_OPTIONS?r.VALIDATION_MESSAGES.REQUIRED_OPTIONS:void 0:r.VALIDATION_MESSAGES.REQUIRED_QUESTION_TEXT,"validateResultPatternForm",0,(e,t,s)=>e.trim()?t.trim()?s<r.UI_CONSTANTS.MIN_CONDITIONS?r.VALIDATION_MESSAGES.REQUIRED_CONDITIONS:void 0:r.VALIDATION_MESSAGES.REQUIRED_MESSAGE:r.VALIDATION_MESSAGES.REQUIRED_RESULT_NAME],36841),e.s(["confirmAction",0,e=>window.confirm(e),"handleError",0,(e,r,t)=>{console.error(`${e}:`,r),alert(t)}],72585);var t=e.i(71645);function s(e,r=[]){let[a,i]=(0,t.useState)(void 0),[n,l]=(0,t.useState)(!0),[d,o]=(0,t.useState)(void 0),c=(0,t.useRef)(void 0),u=(0,t.useCallback)(async()=>{c.current&&c.current.abort();let r=new AbortController;c.current=r;try{l(!0),o(void 0);let t=await e();c.current!==r||r.signal.aborted||i(t)}catch(e){c.current!==r||r.signal.aborted||(o(e instanceof Error?e:Error(String(e))),console.error("Failed to load data:",e))}finally{c.current!==r||r.signal.aborted||l(!1)}},[e]);return(0,t.useEffect)(()=>(u(),()=>{c.current&&c.current.abort()}),r),{data:a,loading:n,error:d,refresh:u}}function a(e,r){let[s,a]=(0,t.useState)(r),[i,n]=(0,t.useState)(!1),[l,d]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{n(!0),d(!0);try{let r=window.localStorage.getItem(e);r&&a(JSON.parse(r))}catch(r){console.error(`Error loading localStorage key "${e}":`,r)}finally{d(!1)}},[e]),[s,(0,t.useCallback)(r=>{try{a(t=>{let s=r instanceof Function?r(t):r;return i&&window.localStorage.setItem(e,JSON.stringify(s)),s})}catch(r){console.error(`Error saving localStorage key "${e}":`,r)}},[e,i]),(0,t.useCallback)(()=>{try{a(r),i&&window.localStorage.removeItem(e)}catch(r){console.error(`Error clearing localStorage key "${e}":`,r)}},[e,r,i]),l]}function i(e){let[r,s]=(0,t.useState)(void 0),[a,i]=(0,t.useState)(!1),[n,l]=(0,t.useState)(e()),d=(0,t.useCallback)(()=>{l(e()),s(void 0),i(!1)},[e]),o=(0,t.useCallback)((e,r)=>{s(e),l(r(e)),i(!1)},[]),c=(0,t.useCallback)(r=>{i(!0),s(void 0),l({...e(),...r})},[e]);return{editing:r,isCreating:a,formData:n,setFormData:l,resetForm:d,startEdit:o,startCreate:c}}e.s(["useAsyncData",()=>s],56309),e.s(["useLocalStorage",()=>a],53902),e.s(["useCRUDManager",()=>i],52928),e.s([],32832)},16787,58594,48350,41635,e=>{"use strict";var r=e.i(43476);let t=({size:e="md",label:t="読み込み中...",className:s=""})=>(0,r.jsxs)("div",{className:`flex items-center justify-center ${s}`,role:"status",children:[(0,r.jsx)("div",{className:`${{sm:"w-4 h-4 border-2",md:"w-8 h-8 border-2",lg:"w-12 h-12 border-4"}[e]} border-blue-200 border-t-blue-600 rounded-full animate-spin dark:border-gray-600 dark:border-t-blue-400`,"aria-hidden":"true"}),(0,r.jsx)("span",{className:"sr-only",children:t})]});e.s(["Spinner",0,t],58594),e.s(["LoadingScreen",0,({message:e="読み込み中..."})=>(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center p-6",children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)(t,{size:"lg",label:e}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 animate-pulse",children:e})]})})],48350);let s={"gradient-blue":"bg-gradient-to-r from-blue-500 to-cyan-500 text-white shadow-md","gradient-purple":"bg-gradient-to-r from-purple-700 to-pink-700 text-white shadow-md","gradient-green":"bg-gradient-to-r from-green-500 to-teal-500 text-white shadow-md",default:"bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-blue-900 dark:to-indigo-900 border-2 border-blue-200 dark:border-blue-700 shadow-lg"};e.s(["GradientCard",0,({children:e,className:t="",variant:a="default"})=>(0,r.jsx)("div",{className:`${s[a]} rounded-lg ${t}`,children:e})],41635),e.s([],16787)},95241,14131,67856,56867,3380,e=>{"use strict";var r=e.i(71645),t=e.i(56348),s=e.i(86134),a=e.i(85149);let i=async e=>(0,s.documentExists)(a.COLLECTIONS.ADMINS,e);e.s(["isAdmin",0,i],14131),e.s(["useAdminAccess",0,()=>{let{user:e,loading:s}=(0,t.useAuth)(),[a,n]=(0,r.useState)(!1),[l,d]=(0,r.useState)(!0),o=(0,r.useRef)(void 0);return(0,r.useEffect)(()=>{let r=!1,t=async()=>{let t=e?.uid??null;if(e&&!e.isAnonymous)try{let s=await i(e.uid);if(r)return;n(s),o.current=t}catch(e){if(r)return;console.error("管理者権限の確認に失敗しました:",e),n(!1),o.current=t}finally{if(r)return;d(!1)}else{if(r)return;n(!1),o.current=t,d(!1)}};if(!s){let r=e?.uid??null;o.current!==r&&(d(!0),t())}return()=>{r=!0}},[e,s]),{user:e,loading:s,isAdminUser:a,checking:l}}],95241);var n=e.i(43476);e.s(["UnauthorizedAccess",0,e=>{let r="not-logged-in"===e.type;return(0,n.jsx)("div",{className:"p-6 max-w-2xl mx-auto",children:(0,n.jsxs)("div",{className:`border rounded p-6 ${r?"bg-red-50 dark:bg-red-900 border-red-200 dark:border-red-800":"bg-yellow-50 dark:bg-yellow-900 border-yellow-200 dark:border-yellow-800"}`,children:[(0,n.jsx)("h2",{className:`text-xl font-bold mb-2 ${r?"text-red-800 dark:text-red-200":"text-yellow-800 dark:text-yellow-200"}`,children:r?"アクセス権限がありません":"管理者権限がありません"}),(0,n.jsx)("p",{className:`mb-4 ${r?"text-red-600 dark:text-red-300":"text-yellow-700 dark:text-yellow-300"}`,children:r?"管理者としてログインする必要があります。":(0,n.jsxs)(n.Fragment,{children:["このアカウントには管理者権限が付与されていません。",(0,n.jsx)("br",{}),"UID: ",e.uid]})}),(0,n.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",onClick:e.onAction,children:r?"ホームに戻る":"ログアウト"})]})})}],67856),e.s(["AdminHeader",0,({email:e,userId:r,onLogout:t})=>(0,n.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"管理者画面"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e||r})]}),(0,n.jsx)("button",{className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",onClick:t,children:"ログアウト"})]})],56867),e.i(51718);var l=e.i(18357),d=e.i(59141);let o=async()=>{await (0,l.signOut)(d.auth)};e.s(["signOut",0,o],3380)},37904,e=>{"use strict";var r=e.i(43476),t=e.i(79472),s=e.i(79268),a=e.i(56867);e.i(32832);var i=e.i(56309);e.i(16787);var n=e.i(58594),l=e.i(85149);e.s(["ResultScreen",0,({userEmail:e,userId:d,onLogout:o})=>{let{data:c,loading:u}=(0,i.useAsyncData)(t.getQuestions);return u?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)(n.Spinner,{size:"lg",label:"アンケート結果を読み込んでいます..."})}):(0,r.jsxs)("main",{className:"p-6 max-w-6xl mx-auto",children:[(0,r.jsx)(a.AdminHeader,{email:e,userId:d,onLogout:o}),(0,r.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,r.jsx)("a",{href:`${l.BASE_PATH}/admin`,className:"px-4 py-2 rounded bg-gray-200 text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",children:"← 管理画面トップ"}),(0,r.jsx)("a",{href:`${l.BASE_PATH}/admin/questions`,className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",children:"質問編集 →"})]}),(0,r.jsx)("div",{className:"space-y-8",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"回答結果"}),(0,r.jsx)(s.ResultList,{questions:c||[]})]})})]})}])},17051,e=>{"use strict";var r=e.i(43476),t=e.i(95241),s=e.i(67856),a=e.i(37904),i=e.i(3380);e.i(16787);var n=e.i(48350),l=e.i(85149);function d(){let{user:e,loading:d,isAdminUser:o,checking:c}=(0,t.useAdminAccess)(),u=async()=>{await (0,i.signOut)(),window.location.href=l.BASE_PATH+"/"};return d||c?(0,r.jsx)(n.LoadingScreen,{}):!e||e.isAnonymous?(0,r.jsx)(s.UnauthorizedAccess,{type:"not-logged-in",onAction:()=>{window.location.href=l.BASE_PATH+"/"}}):o?(0,r.jsx)(a.ResultScreen,{userEmail:e.email,userId:e.uid,onLogout:u}):(0,r.jsx)(s.UnauthorizedAccess,{type:"insufficient-permissions",uid:e.uid,onAction:u})}e.s(["default",()=>d])}]);