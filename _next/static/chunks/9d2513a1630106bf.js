(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,s,a)=>{s.exports=e.r(76562)},52683,e=>{"use strict";var s=e.i(43476),a=e.i(56348),t=e.i(71645);e.i(51718);var l=e.i(18357),i=e.i(59141);let d=async(e,s)=>{await (0,l.signInWithEmailAndPassword)(i.firebaseAuth,e,s)},n=()=>{let[e,a]=(0,t.useState)(""),[l,i]=(0,t.useState)(""),[n,r]=(0,t.useState)(!1),c=async()=>{r(!0);try{await d(e,l)}catch{alert("ログインに失敗しました")}finally{r(!1)}};return(0,s.jsxs)("div",{className:"p-4 border rounded space-y-2",children:[(0,s.jsx)("h2",{className:"font-bold",children:"管理者ログイン"}),(0,s.jsx)("input",{className:"border px-2 py-1 w-full",placeholder:"Email",value:e,onChange:e=>a(e.target.value)}),(0,s.jsx)("input",{className:"border px-2 py-1 w-full",type:"password",placeholder:"Password",value:l,onChange:e=>i(e.target.value)}),(0,s.jsx)("button",{className:"bg-blue-600 text-white px-3 py-1 rounded w-full",onClick:c,disabled:n,children:"ログイン"})]})},r=async()=>(await (0,l.signInAnonymously)(i.firebaseAuth)).user,c=()=>{let e=async()=>{await r()};return(0,s.jsxs)("div",{className:"p-6 border rounded-lg shadow",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-4",children:"一般ユーザー"}),(0,s.jsx)("p",{className:"text-sm mb-4 text-gray-600",children:"アンケートに回答する場合はこちら"}),(0,s.jsx)("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",onClick:e,children:"アンケートに回答する"})]})},o=()=>(0,s.jsxs)("main",{className:"p-6 max-w-2xl mx-auto space-y-6",children:[(0,s.jsx)("div",{className:"text-center mb-6",children:(0,s.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"アンケートシステム"})}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,s.jsx)(c,{}),(0,s.jsx)(n,{})]})]}),u=({onSubmit:e})=>{let[a,l]=(0,t.useState)("");return(0,s.jsxs)("div",{className:"max-w-sm mx-auto p-6 bg-white rounded-xl shadow",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-4",children:"名前を入力してください"}),(0,s.jsx)("input",{className:"w-full border rounded px-3 py-2 mb-4",value:a,onChange:e=>l(e.target.value),placeholder:"表示名"}),(0,s.jsx)("button",{className:"w-full bg-blue-600 text-white py-2 rounded disabled:opacity-50",disabled:!a,onClick:()=>e(a),children:"決定"})]})};var m=e.i(79268),x=e.i(79472);e.i(36180);var p=e.i(98925);let h=async e=>{await (0,p.addDoc)((0,p.collection)(i.firestore,"answers"),{userId:e.userId,userName:e.userName,questionId:e.questionId,selectedOption:e.selectedOption,createdAt:(0,p.serverTimestamp)()})},b=({userId:e,userName:a})=>{let[l,i]=(0,t.useState)([]),[d,n]=(0,t.useState)({}),[r,c]=(0,t.useState)(!0);(0,t.useEffect)(()=>{(0,x.getQuestions)().then(e=>{i(e),c(!1)})},[]);let o=async()=>{for(let s of l){let t=d[s.id];t&&await h({userId:e,userName:a,questionId:s.id,selectedOption:t,createdAt:new Date})}alert("回答を送信しました")};return r?(0,s.jsx)("p",{children:"Loading..."}):(0,s.jsxs)("div",{className:"space-y-6",children:[l.map(e=>(0,s.jsxs)("div",{className:"p-4 border rounded",children:[(0,s.jsx)("p",{className:"font-bold mb-2",children:e.text}),e.options.map(a=>(0,s.jsxs)("label",{className:"block mb-1",children:[(0,s.jsx)("input",{type:"radio",name:e.id,value:a,checked:d[e.id]===a,onChange:()=>n(s=>({...s,[e.id]:a}))}),(0,s.jsx)("span",{className:"ml-2",children:a})]},a))]},e.id)),(0,s.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded",onClick:o,children:"送信"}),(0,s.jsx)(m.ResultList,{questions:l})]})},j=async e=>{let s=(0,p.doc)(i.firestore,"users",e.uid);await (0,p.setDoc)(s,{displayName:e.displayName,createdAt:(0,p.serverTimestamp)()})},N=({userId:e})=>{let[a,l]=(0,t.useState)(null);return a?(0,s.jsx)("main",{className:"p-6",children:(0,s.jsx)(b,{userId:e,userName:a})}):(0,s.jsx)("main",{className:"p-6",children:(0,s.jsx)(u,{onSubmit:async s=>{await j({uid:e,displayName:s,createdAt:new Date}),l(s)}})})};var y=e.i(18566);function w(){let{user:e,loading:t}=(0,a.useAuth)(),l=(0,y.useRouter)();return!e||t||e.isAnonymous?t?(0,s.jsx)("p",{className:"p-6",children:"Loading..."}):e?(0,s.jsx)(N,{userId:e.uid}):(0,s.jsx)(o,{}):(l.push("/admin"),(0,s.jsx)("p",{className:"p-6",children:"管理者画面に移動中..."}))}e.s(["default",()=>w],52683)}]);