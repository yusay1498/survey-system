# 次のステップ (Next Steps)

このガイドでは、アプリケーションのセットアップとテストの手順を説明します。

## 1. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで http://localhost:3000 を開きます。

## 2. 管理者の設定

管理者アカウントの作成方法については、[管理者セットアップガイド](./ADMIN_SETUP.md) を参照してください。

## 3. テスト手順

### A. 一般ユーザーとしてテスト

1. http://localhost:3000/ にアクセス
2. 「アンケートに回答する」ボタンをクリック
3. 表示名を入力（例: "山田太郎"）
4. アンケートに回答

**注意**: 最初は質問がないため、管理者で質問を作成する必要があります。

### B. 管理者としてテスト

1. http://localhost:3000/ にアクセス
2. 管理者のメールアドレスとパスワードでログイン
3. `/admin` に自動リダイレクトされることを確認
4. 質問と結果パターンの管理機能をテスト

### C. 管理者画面で質問を作成

1. 「新規質問作成」ボタンをクリック
2. 質問文を入力（例: "好きな色は？"）
3. 選択肢を入力（例: "赤"、"青"、"緑"）
4. 「作成」ボタンをクリック
5. 質問がリストに表示されることを確認

### D. 結果パターンを作成

1. 「新規パターン作成」ボタンをクリック
2. パターン名、メッセージ、条件を入力
3. 「作成」ボタンをクリック
4. パターンがリストに表示されることを確認

詳細は [結果パターン設定ガイド](./RESULT_PATTERNS.md) を参照してください。

### E. 一般ユーザーで回答をテスト

1. 別のブラウザまたはシークレットウィンドウで http://localhost:3000/ を開く
2. 「アンケートに回答する」をクリック
3. 名前を入力
4. 作成した質問に回答
5. 「送信」ボタンをクリック
6. パーソナライズされた結果または集計結果が表示されることを確認

### F. 管理者で結果を確認

1. 管理者画面で下にスクロール
2. 「回答結果」セクションに回答が表示されることを確認

## よくある問題と解決方法

### 問題: 「管理者権限がありません」と表示される

**解決方法:**
- Firestoreの `admins` コレクションに正しいUIDが設定されているか確認
- 画面に表示されているUIDと、FirestoreのドキュメントIDが一致しているか確認

詳細は [管理者セットアップガイド](./ADMIN_SETUP.md) のトラブルシューティングを参照してください。

### 問題: ログインできない

**解決方法:**
- Firebase Authenticationでユーザーが作成されているか確認
- メールアドレスとパスワードが正しいか確認
- ブラウザのコンソールでエラーメッセージを確認

### 問題: 質問が表示されない

**解決方法:**
- 管理者でログインして質問を作成してください
- Firestoreの `questions` コレクションにドキュメントがあるか確認

### 問題: 結果パターンが表示されない

**解決方法:**
- 条件が正しく設定されているか確認
- ユーザーの回答がすべての条件を満たしているか確認

詳細は [結果パターン設定ガイド](./RESULT_PATTERNS.md) のトラブルシューティングを参照してください。

## 本番環境へのデプロイ前に

### セキュリティルールの更新が必須

現在のFirestoreルールは開発用です。本番環境では [管理者セットアップガイド](./ADMIN_SETUP.md) に記載されている適切なセキュリティルールに更新してください。

### 環境変数の確認

以下の環境変数が設定されていることを確認:
- `NEXT_PUBLIC_FIREBASE_API_KEY`
- `NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN`
- `NEXT_PUBLIC_FIREBASE_PROJECT_ID`
- `NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET`
- `NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID`
- `NEXT_PUBLIC_FIREBASE_APP_ID`

## 関連ドキュメント

- [開発ガイド](../technical/DEVELOPMENT.md) - 開発環境のセットアップ
- [管理者セットアップガイド](./ADMIN_SETUP.md) - 管理者アカウントの作成
- [実装内容の説明](../technical/IMPLEMENTATION_SUMMARY.md) - システムの技術的な詳細
- [結果パターン設定ガイド](./RESULT_PATTERNS.md) - パーソナライズされた結果の設定
- [サンプルデータガイド](./SAMPLE_DATA.md) - テスト用サンプルデータ
